<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JS中的同步异步编程</title>
</head>

<body>
    <script type="text/javascript">
        // JS三座山：作用域、原型链、同异步
        // JS解析：从上到下
        // 单线程：同一时间只能进行一个任务
        // 浏览器：多线程：可以同一个时间内执行多个任务
        // 定时器：分清开始放入队列的时间，和要经历的时间
        console.log(1);
        setTimeout(() => {
            console.log(2);
        }, 100);
        console.log(3);

        /*
            Ajax: 可以是同步，可以是异步
            如果是同步(false --> 4)，当前ajax请求不完成，不能执行和下面的代码；
            只当ajax请求完成，会默认调用一次xhr的监听函数onreadystatechange;
            如果是异步(true --> 2,3,4)，每当readyState改变一次，就会调用执行一次
            2：接收到响应头
            3：正在接收响应头
            4：已经完成接收
        */
        // ajax
        let xhr = new XMLHttpRequest();
        xhr.open("get", "./text.json", true);
        xhr.onreadystatechange = function () {
            console.log(xhr.readyState);
            // if (xhr.readyState === 4 && /^2\d{2}$/.test(xhr.status)) {
            //     console.log(xhr.responseText);
            // }
        }
        xhr.send();

        /*
            JS异步：setTimeout、ajax、事件(onload)
            在JS中分为执行队列（执行栈），等待队列
            当遇到异步的任务，会把该任务对应的回调函数放到等待队列中；
            当执行队列中的执行完毕，再去等待队列查看满足条件的任务，把其对应的回调放到主任务队列中执行；
            主任务队列也叫执行栈
        */

    </script>
</body>

</html>